library(gsFisher)
devtools::document()
devtools::document()
library(gsFisher)
?fetchKEGG
kegg <- fetchKEGG(species="mm")
library(gsFisher)
kegg <- fetchKEGG(species="mm")
head(kegg)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/m"
fg <- read.file(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz"))
)
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/m"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T))
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
head(bg)
ann <- fetchAnnotation(species = "mm")
?fetchAnnotation
library(gsFisher)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
ann <- fetchAnnotation(species = "mm")
library(gsFisher)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
ann <- fetchAnnotation(species = "mm")
head(ann)
fg_ids <- ann$entrez_id[ann$ensembl_id %in% fg$gene_id]
bg_ids <- ann$entrez_id[ann$ensembl_id %in% bg$gene_id]
?runGO
go <- runGO(fg_ids, bg_ids, ann, "mm")
head(go)
?runKEGG
?fetchKEGG
kegg <- fetchKEGG(species="mm")
head(kegg)
names(kegg)
names(kegg)
library(gsFisher)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
ann <- fetchAnnotation(species = "mm")
kegg <- runKEGG(fg_ids,bg_ids,annotation = ann,species = "mm")
library(gsFisher)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
ann <- fetchAnnotation(species = "mm")
fg_ids <- ann$entrez_id[ann$ensembl_id %in% fg$gene_id]
bg_ids <- ann$entrez_id[ann$ensembl_id %in% bg$gene_id]
kegg <- runKEGG(fg_ids,bg_ids,annotation = ann,species = "mm")
names(kegg)
head(kegg)
library(gsFisher)
fdir <- "/gfs/work/ssansom/10x/udalova_chimera/seurat_CC/agg.seurat.dir/25_1_1_MAST.cluster.dir/"
fg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.txt.gz")),
sep="\t",header=T,as.is=T)
bg <- read.table(gzfile(file.path(fdir,"markers.between.genotype.cluster.1.universe.txt.gz")),
sep="\t",header=T,as.is=T)
ann <- fetchAnnotation(species = "mm")
fg_ids <- ann$entrez_id[ann$ensembl_id %in% fg$gene_id]
bg_ids <- ann$entrez_id[ann$ensembl_id %in% bg$gene_id]
gmtfile <- "/gfs/mirror/msigdb/wehi/
library(bioMart)
gmtfile <- "/gfs/mirror/msigdb/wehi/
library(bioMart)
""
library(bioMart)
library(biomArt)
require(biomaRt)
dataset="hsapiens_gene_ensembl"
ensembl = useEnsembl(biomart="ensembl", dataset=dataset,
version="latest")
listAttributes
listAttributes(ensembl)
ensembl = useEnsembl(biomart="ensembl", dataset=dataset,
version="latest")
dataset="hsapiens_gene_ensembl"
ensembl = useEnsembl(biomart="ensembl", dataset=dataset,
version="latest")
ensembl = useEnsembl(biomart="ensembl", dataset=dataset)
listAttributes(ensembl)
attr <- listAttributes(ensembl)
grepl("muscu",attr)
attr[grepl("muscu",attr)]
names(attr)
attr[grepl("muscu",attr$name),]
annotation <- getBM(attributes=c('ensembl_gene_id','entrezgene','mmusculus_homolog_ensembl_gene'),
mart = ensembl)
annotation <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = ensembl)
head(annotation)
?getBM
human2mouse <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = ensembl)
human2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = ensembl)
humanEnsembl <- useEnsembl(biomart="ensembl", dataset="hsapiens_gene_ensembl")
mouseEnsembl <- useEnsembl(biomart="ensembl", dataset="mmusculus_gene_ensembl")
human2mouse <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = humanEnsembl)
human2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = humanEnsembl)
mouse2entrez <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = mouseEnsembl)
mouse2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = mouseEnsembl)
head(human2entrez)
head(human2mouse)
head(mouse2entrez)
mapGMT2mouse <- function(GMT)
{
require(biomaRt)
humanEnsembl <- useEnsembl(biomart="ensembl", dataset="hsapiens_gene_ensembl")
mouseEnsembl <- useEnsembl(biomart="ensembl", dataset="mmusculus_gene_ensembl")
attr <- listAttributes(ensembl)
attr[grepl("muscu",attr$name),]
human2mouse <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = humanEnsembl)
human2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = humanEnsembl)
mouse2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = mouseEnsembl)
mmGMT <- list()
for(category  in names(GMT))
{
human_entrez <- GMT[[category]]
human_ensembl <- human2entrez$ensembl_gene_id[human2entrez$entrezgene %in% GMT[[category]]]
mouse_homolog <- human2mouse$mmusculus_homolog_ensembl_gene[human2mouse$ensembl_gene_id %in% human_ensembl]
mmGMT[[category]] <- unique(mouse2entrez$entrezgene[mouse2entrez$ensembl_gene_id %in% mouse_homolog])
}
mmGMT
}
gmt <- readGMT("/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.gmt")
mmGMT <- mapGMT2Mouse(gmt)
mmGMT <- mapGMT2mouse(gmt)
head(mmGMT)
mapGMT2mouse <- function(GMT)
{
require(biomaRt)
humanEnsembl <- useEnsembl(biomart="ensembl", dataset="hsapiens_gene_ensembl")
mouseEnsembl <- useEnsembl(biomart="ensembl", dataset="mmusculus_gene_ensembl")
attr <- listAttributes(ensembl)
attr[grepl("muscu",attr$name),]
human2mouse <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene'),
mart = humanEnsembl)
human2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = humanEnsembl)
mouse2entrez <- getBM(attributes=c('ensembl_gene_id','entrezgene'),
mart = mouseEnsembl)
mmGMT <- list()
for(category  in names(GMT))
{
human_entrez <- GMT[[category]]
human_ensembl <- human2entrez$ensembl_gene_id[human2entrez$entrezgene %in% GMT[[category]]]
mouse_homolog <- human2mouse$mmusculus_homolog_ensembl_gene[human2mouse$ensembl_gene_id %in% human_ensembl]
mouse_entrez <- unique(mouse2entrez$entrezgene[mouse2entrez$ensembl_gene_id %in% mouse_homolog])
mmGMT[[category]] <- mouse_entrez[!is.na(mouse_entrez)]
}
mmGMT
}
gmt <- readGMT("/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.gmt")
mmGMT <- mapGMT2mouse(gmt)
runGMT(fg_ids,bg_ids,mmGMT,annotation = ann)
library(gsFisher)
gmt_e <- runGMT(fg_ids, bg_ids, gmt, translate2mouse = TRUE, annotation = anno)
library(gsFisher)
gmt_e <- runGMT(fg_ids, bg_ids, gmt, translate2mouse = TRUE, annotation = anno)
gmt_e <- runGMT(fg_ids, bg_ids, gmt, translate2mouse = TRUE, annotation = ann)
head(gmt_e)
head(kegg)
head(go)
library(gsFisher)
library(gsFisher)
kegg <- fetchKEGG(species="mm")
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=c(),
translateGMT2mouse=FALSE,
species="hs")
gmts <- list(biocarta="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.gmt",
reactome="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.reactome.v6.0.entrez.gmt")
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
translateGMT2mouse=TRUE,
species="mm")
gmts
paste(c(1,2,3))
paste(c(1,2,3),sep="\t"))
paste(c(1,2,3),sep="\t")
paste(c(1,2,3),sep="_")
paste(c(1,2,3),collaose="_")
paste(c(1,2,3),collapse="_")
?writeLites
?writeLines
library(gsFisher)
library(gsFisher)
library(gsFisher)
library(gsFisher)
library(gsFisher)
con <- file("temp.txt")
writeLines("adsfa",con)
close(con)
library(gsFisher)
library(gsFisher)
library(gsFisher)
library(gsFisher)
gmts <- list(biocarta="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.mouse.gmt",
reactome="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.reactome.v6.0.entrez.mouse.gmt")
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
species="mm")
gmts <- list(biocarta="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.mouse.gmt",
reactome="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.reactome.v6.0.entrez.mouse.gmt")
library(gsFisher)
gmts <- list(biocarta="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.biocarta.v6.0.entrez.mouse.gmt",
reactome="/gfs/mirror/msigdb/msigdb_v6.0/msigdb_v6.0_GMTs/c2.cp.reactome.v6.0.entrez.mouse.gmt")
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
species="mm")
library(gsFisher)
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
species="mm")
names(res)
head(res$GO.BP)
head(res$GO.MG)
head(res$GO.MF)
head(res$GO.CC)
head(res$KEGG)
head(res$biocarta)
head(res$reactome)
attr <- listAttributes(ensembl)
attr[grepl("muscu",attr$name),]
humanEnsembl <- useEnsembl(biomart="ensembl", dataset="hsapiens_gene_ensembl")
mouseEnsembl <- useEnsembl(biomart="ensembl", dataset="mmusculus_gene_ensembl")
human2mouse <- getBM(attributes=c('ensembl_gene_id','mmusculus_homolog_ensembl_gene',
'mmusculus_homolog_orthology_type'),
mart = humanEnsembl)
head(human2mouse)
unique(human2mouse$mmusculus_homolog_orthology_type)
table(human2mouse$mmusculus_homolog_orthology_type)
library(gsFisher)
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
species="mm")
gmts <- list(biocarta="/gfs/mirror/msigdb/msigdb_v6.1/msigdb_v6.1_GMTs/c2.cp.biocarta.v6.1.entrez.mouse.gmt",
reactome="/gfs/mirror/msigdb/msigdb_v6.1/msigdb_v6.1_GMTs/c2.cp.reactome.v6.1.entrez.mouse.gmt")
res <- analyseGenesets(fg_ids,
bg_ids,
annotation,
kegg_pathways=kegg,
gmt_files=gmts,
species="mm")
strsplit("sadf,"£34",",")
strsplit("sadf,"34",",")
strsplit("sadf,"a34",",")
strsplit("sadf",",")
strsplit("sadf",",")[[1]]
strsplit("sa,df",",")[[1]]
library(gsFisher)
library(gsfisher)
library(gsfisher)
?sampleEnrichmentHeatmap
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets.*.KEGG.txt.gz")
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets\.*.KEGG.txt.gz")
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets..*.KEGG.txt.gz")
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets[\.].*.KEGG.txt.gz")
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets.*.KEGG.txt.gz")
Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets.*.KEGG.txt.gz")[1:7]
test_files <-Sys.glob("/gfs/work/ssansom/10x/tenx_release/test_udalova/agg.seurat.dir/25_0.8_1_wilcox.cluster.dir/genesets.*.KEGG.txt.gz")[1:7]
begin=T
for(f in test_files)
{
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
if(begin)
{
rest <- temp
begin <- FALSE
} else {
rbind(res,temp)}
}
head(res)
head(temp)
head(temp,n=2)
for(f in test_files)
begin=T
sample <- 1
for(f in test_files)
{
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- as.character(sample)
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
j <- j+1
}
begin=T
sample <- 1
for(f in test_files)
{
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- as.character(sample)
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
sample <- sample+1
}
head(cres)
sampleEnrichmentHeatmap(cres)
library(gsfisher)
sampleEnrichmentHeatmap(cres)
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
library(gsfisher)
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
library(gsfisher)
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
names(cres)
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
head(temp)
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
cres[is.na(cres$geneset_id),]
cres[is.na(cres$odds.ratio),]
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
colnames(cres)
unique(cres$sample)
begin=T
sample <- 1
for(f in test_files)
{
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- as.character(sample)
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
sample <- sample + 1
}
unique(cres$sample)
begin=T
sample <- 1
for(f in test_files)
{
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- sample
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
sample <- sample + 1
}
unique(cres$sample)
cres <- NULL
begin=T
sample <- 1
for(f in test_files)
{
print(sample)
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- sample
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
sample <- sample + 1
}
unique(cres$sample)
begin=T
sample <- 1
for(f in test_files)
{
print(sample)
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- sample
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
print(dim(cres))
sample <- sample + 1
}
begin=T
sample <- 1
for(f in test_files)
{
print(sample)
print(begin)
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- sample
if(begin)
{
cres <- temp
begin <- FALSE
} else {
rbind(cres,temp)}
print(dim(cres))
sample <- sample + 1
}
begin=T
sample <- 1
for(f in test_files)
{
print(sample)
print(begin)
temp <- read.table(gzfile(f),header=T,sep="\t",as.is=T)
temp$sample <- sample
if(begin)
{
cres <- temp
begin <- FALSE
} else {
cres <- rbind(cres,temp)}
print(dim(cres))
sample <- sample + 1
}
unique(cres$sample)
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
dev.off()
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
sampleEnrichmentHeatmap(cres,sample_id_col="sample")
source('/gfs/home/ssansom/devel/gsfisher/R/Plot.R')
library(gsfisher)
